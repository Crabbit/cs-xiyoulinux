<meta charset="utf-8">
<?php
$con = new Csdb();
var_dump($con->query("insert into cs_app(name,status) values('测试', 1);"));
$result = $con->query("select grade from cs_user;");
var_dump($result->fetch_assoc());
var_dump(mysqli_fetch_array($con->query("select * from cs_app")));
class Csdb{
	private $hostname;
	private $dbuser;
	private $dbpwd;
	private $dbname;
	private $charName;
	private $db;

	private $res;
	
	function __construct()
	{
		$hostname = "localhost";
		$dbuser = "root";
		$dbpwd = "perfect456";
		$dbname = "cs_team";
		$charName = "utf8";

		$this->db = new mysqli($hostname, $dbuser, $dbpwd, $dbname);

		if (mysqli_connect_errno())
		{
			echo "链接失败".mysqli_connect_errno();
			exit();
		}
		$this->db->query("set name $charName;");

		return $this->db;
	}

	public function query($sql)
	{
		$this->res = $this->db->query($sql);
		return $this->res;
	}

	function __destruct()
	{
		$this->res->free();
		$this->db->close();
	}
}
?>
